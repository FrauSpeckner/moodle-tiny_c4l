define("tiny_c4l/management",["exports","core_form/modalform","core/str","core/notification","core/ajax","core/localstorage"],(function(_exports,_modalform,_str,_notification,_ajax,_localstorage){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=_exports.deleteItem=void 0,_modalform=_interopRequireDefault(_modalform),_localstorage=_interopRequireDefault(_localstorage);function showModal(e,id,table){let title;e.preventDefault(),title=0==id?(0,_str.get_string)("additem","tiny_c4l"):(0,_str.get_string)("edititem","tiny_c4l");const modalForm=new _modalform.default({formClass:"tiny_c4l\\form\\management_"+table+"_form",args:{id:id},modalConfig:{title:title}});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(()=>location.reload())),modalForm.show()}_exports.init=async()=>{document.getElementsByClassName("add").forEach((element=>{element.addEventListener("click",(async e=>{showModal(e,element.dataset.id,element.dataset.table)}))})),document.getElementsByClassName("edit").forEach((element=>{element.addEventListener("click",(async e=>{showModal(e,element.dataset.id,element.dataset.table)}))})),document.getElementById("c4l_import").addEventListener("click",(async e=>{!function(e){e.preventDefault();let title=(0,_str.get_string)("import","tiny_c4l");const modalForm=new _modalform.default({formClass:"tiny_c4l\\form\\management_import_form",args:{},modalConfig:{title:title}});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(()=>location.reload())),modalForm.show()}(e)})),document.getElementsByClassName("delete").forEach((element=>{element.addEventListener("click",(async e=>{!function(e,id,title,table){e.preventDefault(),(0,_notification.deleteCancelPromise)((0,_str.get_string)("delete","tiny_c4l",title),(0,_str.get_string)("deletewarning","tiny_c4l")).then((async()=>{if(0!==id)try{if(await deleteItem(id,table)){const link=document.querySelector('[data-table="'+table+'"][data-id="'+id+'"]');if(link){link.closest(".item").remove()}}}catch(error){(0,_notification.exception)(error)}})).catch((()=>{}))}(e,element.dataset.id,element.dataset.title,element.dataset.table)}))})),document.getElementsByClassName("compcat").forEach((element=>{element.addEventListener("click",(async e=>{!function(e,compcat){document.querySelectorAll(".flavor, .component, .variant").forEach((element=>{element.classList.add("hidden")}));let itemsShow=document.getElementsByClassName(compcat),usedFlavors=[];itemsShow.forEach((element=>{element.classList.remove("hidden");let flavors=element.dataset.flavors.split(" ");for(let value of flavors)usedFlavors.includes(value)||0==value.length||usedFlavors.push(value)}));let flavorstring=usedFlavors.map((item=>".".concat(item))).join(", ");if(flavorstring.length){document.querySelectorAll(flavorstring).forEach((element=>{element.classList.remove("hidden")}))}document.getElementsByClassName("addcontainer").forEach((element=>{element.classList.remove("hidden")}))}(0,element.dataset.compcat)}))})),document.getElementById("c4l_compflavor_button").addEventListener("click",(async e=>{!function(e){e.preventDefault();let title=(0,_str.get_string)("manage","tiny_c4l");const modalForm=new _modalform.default({formClass:"tiny_c4l\\form\\management_comp_flavor_form",args:{},modalConfig:{title:title}});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(()=>location.reload())),modalForm.show()}(e)})),document.querySelectorAll(".flavor .card-body > div, .component .card-body > div, .variant .card-body > div").forEach((element=>{element.addEventListener("click",(async e=>{e.target.closest(".item").querySelector("a.edit").click()}))}))};const deleteItem=(id,table)=>(0,_ajax.call)([{methodname:"tiny_c4l_delete_item",args:{id:id,table:table}}])[0];_exports.deleteItem=deleteItem}));

//# sourceMappingURL=management.min.js.map